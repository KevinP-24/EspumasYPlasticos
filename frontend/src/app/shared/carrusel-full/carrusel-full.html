<section class="carrusel-container">
  <!-- Encabezado -->
  <div class="carrusel-header" *ngIf="productos.length > 0">
    <h2 class="carrusel-title">{{ titulo }}</h2>
    <p class="carrusel-subtitle" *ngIf="subtitulo">{{ subtitulo }}</p>
  </div>

  <!-- Estado de carga -->
  <div class="carrusel-loading" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Cargando productos...</p>
  </div>

  <!-- Estado de error -->
  <div class="carrusel-error" *ngIf="error && !isLoading">
    <div class="error-icon">‚ö†Ô∏è</div>
    <h3>Error</h3>
    <p>{{ error }}</p>
  </div>

  <!-- Carrusel principal -->
  <div class="carrusel-main" *ngIf="productos.length > 0 && !isLoading && !error">
    <!-- Bot√≥n anterior -->
    <button 
      class="carrusel-btn carrusel-btn-prev"
      (click)="anterior()"
      [disabled]="isPrevDisabled || isAnimating"
      [attr.aria-label]="'Productos anteriores'"
      [title]="isPrevDisabled ? 'No hay productos anteriores' : 'Ver anteriores'">
      <fa-icon [icon]="faChevronLeft"></fa-icon>
    </button>

    <!-- Contenedor del carrusel -->
    <div class="carrusel-content-wrapper">
      <div class="carrusel-content" #carouselContent>
        <div 
          class="carrusel-track" 
          #carouselTrack
          [style.transform]="getTrackTransform()"
          [class.animating]="isAnimating">
          
          <!-- Tarjeta de producto -->
          <div 
            class="producto-card"
            *ngFor="let producto of productos; let i = index"
            [attr.data-product-id]="producto.id"
            role="article"
            [style.transform]="getCardTransform(i)"
            [style.opacity]="getCardOpacity(i)">
            
            <!-- Imagen -->
            <div class="producto-imagen">
              <img 
                *ngIf="getProductoImagen(producto)"
                [src]="getProductoImagen(producto)"
                [alt]="producto.nombre"
                loading="lazy"
                (error)="handleImageError($event)" />
              <div *ngIf="!getProductoImagen(producto)" class="sin-imagen">üì¶</div>
            </div>

            <!-- Info del producto -->
            <div class="producto-info">
              <h3 class="producto-nombre" [title]="producto.nombre">{{ producto.nombre }}</h3>
              
              <span class="producto-subcategoria" *ngIf="producto.subcategoria">
                {{ producto.subcategoria }}
              </span>
              
              <div class="producto-footer">
                <div class="producto-precio">{{ formatearPrecio(producto.precio) }}</div>
                <div class="producto-stock">
                  {{ producto.cantidad > 0 ? '‚úì Envio Gratis' : 'Agotado' }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bot√≥n siguiente -->
    <button 
      class="carrusel-btn carrusel-btn-next"
      (click)="siguiente()"
      [disabled]="isNextDisabled || isAnimating"
      [attr.aria-label]="'Siguientes productos'"
      [title]="isNextDisabled ? 'No hay m√°s productos' : 'Ver siguientes'">
      <fa-icon [icon]="faChevronRight"></fa-icon>
    </button>
  </div>

  
  <!-- Sin productos -->
  <div class="carrusel-empty" *ngIf="productos.length === 0 && !isLoading && !error">
    <div class="empty-icon">üì¶</div>
    <h3>No hay productos disponibles</h3>
    <p>Pronto agregaremos m√°s productos.</p>
  </div>
</section>